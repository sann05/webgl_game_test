<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | ZombieTrain_Prod</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script> <!-- Telegram SDK -->
	<script src="https://cdn.devtodev.com/sdk/web/v2/devtodevsdk.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script> <!-- TonConnect UI -->
    <style>
      html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
      }
      #unity-container {
        width: 100vw;
        height: 100vh;
        position: absolute;
        top: 0;
        left: 0;
      }
      canvas {
        width: 100% !important;
        height: 100% !important;
        max-width: 1080px;
        margin: 0 auto;
      }
      @media screen and (orientation: landscape) {
        body::before {
          content: "Please rotate your device to portrait mode";
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 24px;
          color: #333;
        }
        canvas {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div id="unity-container" class="unity-desktop">
      <canvas id="unity-canvas" width="1080" height="1920" tabindex="-1"></canvas>
      <div id="unity-loading-bar">
        <div id="unity-logo"></div>
        <div id="unity-progress-bar-empty">
          <div id="unity-progress-bar-full"></div>
        </div>
      </div>
      <div id="unity-warning"></div>
      <div id="unity-footer">
        <div id="unity-webgl-logo"></div>
        <div id="unity-fullscreen-button"></div>
        <div id="unity-build-title">ZombieTrain_Prod</div>
      </div>
	  <div id="bug-game-container" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; pointer-events: auto;">
		<div id="bugs-container" style="position: relative; width: 100%; height: 100%; overflow: hidden;"></div>
	  </div>
    </div>

    <!-- Load Unity WebGL-related script -->
    <script src="unity-loader.js"></script>
    <!-- Load Telegram-related script -->
    <script src="telegram-integration.js"></script>
	
	<script>
		const bugsContainer = document.querySelector('#bugs-container');

		function spawnBug() {
		  const bug = document.createElement('div');
		  bug.className = 'bug';
		  bug.style.width = '50px';
		  bug.style.height = '50px';
		  bug.style.backgroundImage = "url('bug.png')";
		  bug.style.backgroundSize = 'contain';
		  bug.style.backgroundRepeat = 'no-repeat';
		  bug.style.position = 'absolute';
		  bug.style.left = Math.random() * 90 + '%';
		  bug.style.top = Math.random() * 90 + '%';
		  bug.style.cursor = 'pointer';
		  bug.style.transition = 'transform 0.1s ease-in-out';

		  bug.addEventListener('click', () => squashBug(bug));
		  bugsContainer.appendChild(bug);

		  // Auto-remove bug after 5 seconds
		  setTimeout(() => {
			  if (bug && bug.parentNode) bug.remove();
		  }, 5000);
		  }

		  function squashBug(bug) {
			  bug.style.backgroundImage = "url('squashed-bug.png')";
			  bug.style.transform = 'scale(0.8)';
			  bug.style.pointerEvents = 'none'; // Disable further clicks
			  setTimeout(() => bug.remove(), 1000); // Remove bug after 1 second
		  }

		  function startBugGame() {
			  // Spawn bugs at intervals
			  const bugSpawnInterval = setInterval(() => {
				  if (document.readyState === 'complete') {
					  clearInterval(bugSpawnInterval);
					  document.getElementById('bug-game-container').remove(); // Remove mini-game when Unity finishes loading
				  } else {
					  spawnBug();
				  }
			  }, 1000);
		  }

		  // Start the bug game
		  startBugGame();
	</script>

  </body>
</html>
